import{i as m,a as J}from"./vendor-RkJB11I5.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function s(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=s(n);fetch(n.href,r)}})();class q{constructor(e){this.page=e.page,this.perPage=e.perPage,this.totalPages=e.totalPages,this.results=e.results}}class K{constructor(e,s,i){this.filter=e,this.name=s,this.imgURL=i}}class F{constructor(e,s,i){this.filter=e,this.page=s,this.limit=i}}class j extends q{constructor(e){super(e)}getFilters(){return this.results.map(e=>new K(e.filter,e.name,e.imgURL))}}class L{constructor(e,s,i,n,r=1,c=10){this.bodypart=e,this.muscles=s,this.equipment=i,this.keyword=n,this.page=r,this.limit=c}}class w{constructor(e){this.id=e._id,this.bodyPart=e.bodyPart,this.equipment=e.equipment,this.gifUrl=e.gifUrl,this.name=e.name,this.target=e.target,this.description=e.description,this.rating=e.rating,this.burnedCalories=e.burnedCalories,this.time=e.time,this.popularity=e.popularity}}class Y extends q{constructor(e){super(e)}getExercises(){return this.results.map(e=>new w(e))}}class R{constructor(e,s,i){this.rate=e,this.email=s,this.review=i}}class Q{constructor(e){this.quote=e.quote,this.author=e.author}}function _(t){if(t.response)switch(t.response.status){case 400:m.warning({message:"Bad request: invalid request body.",position:"topCenter"});break;case 404:m.error({message:"Endpoint not found.",position:"topCenter"});break;case 409:m.warning({message:"You are already subscribed.",position:"topCenter"});break;case 500:m.error({message:"Server error: please try again later.",position:"topCenter"});break;default:m.error({message:"Unknown server error occurred.",position:"topCenter"})}else m.error({message:"Unexpected error. Please check your connection and try again."});throw console.error("API Error:",t),t}const D="https://your-energy.b.goit.study/api";class W{constructor(){this._api=J.create({baseURL:D,headers:{"Content-Type":"application/json"}})}async fetchFilters(e){try{const s=await this._api.get("/filters",{params:e});return new j(s.data)}catch(s){console.error("Error fetching filters:",s),_(s)}}async fetchExercisesByFilter(e){try{const s=await this._api.get("/exercises",{params:e});return new Y(s.data)}catch(s){console.error("Error fetching exercises by filter:",s),_(s)}}async fetchExercisesById(e){try{const s=await this._api.get(`/exercises/${e}`);return new w(s.data)}catch(s){console.error("Error fetching exercises by ID:",s),_(s)}}async patchExerciseRating(e,s){try{const i=await this._api.patch(`/exercises/${e}/rating`,s);return new w(i.data)}catch(i){console.error("Error updating exercise rating:",i),_(i)}}async fetchQuoteOfTheDay(){try{const e=await this._api.get("/quote");return new Q(e.data)}catch(e){console.error("Error fetching quote of the day:",e),_(e)}}async postSubscription(e){try{return(await this._api.post("/subscription",{email:e})).data.message}catch(s){console.error("Error posting subscription:",s),_(s)}}}const p=new W;function z(){const t=document.createElement("button");t.id="scrollUpBtn",t.title="Up",t.innerHTML=`
    <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none">
      <path d="M12 4L12 20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M5 11L12 4L19 11" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  `,document.body.appendChild(t),window.addEventListener("scroll",()=>{window.scrollY>300?t.classList.add("show"):t.classList.remove("show")}),t.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})})}class G{constructor(){this.backdrop=document.createElement("div"),this.backdrop.className="loader-backdrop",this.backdrop.innerHTML='<div class="loader"></div>'}show(){document.body.contains(this.backdrop)||document.body.appendChild(this.backdrop)}hide(){document.body.contains(this.backdrop)&&document.body.removeChild(this.backdrop)}}const P="/goit-adv-js-final-project-team-5/assets/sprite-D9KaOlX4.svg";function S(t){return t.charAt(0).toUpperCase()+t.slice(1)}const I="favorites";function T(){try{return JSON.parse(localStorage.getItem(I))||[]}catch{return[]}}function X(t){if(!t)return;const e=T(),s=e.indexOf(t);s>=0?e.splice(s,1):e.push(t),localStorage.setItem(I,JSON.stringify(e))}const o={closeModalButton:"[data-modal-close]",modalContainer:"[data-modal]",exerciseModal:".modal",ratingModal:".add-rating-modal",addToFavoritesButton:".btn-modal-add-fav",imgModalExercise:".img-modal-exercise",titleModal:".title-modal",ratingValue:".rating-value",statsList:".stats-list",descText:".desc-text",btnFavText:".btn-fav-text",iconFavBtnUse:".icon-fav-btn-use",openRatingModalButton:"[data-add-rating-open]",closeRatingModalButton:"[data-add-rating-close]",ratingForm:".add-rating-form",addRatingValue:".add-rating-value",iconModalRatingStar:".icon-modal-rating-star",addRatingRadioBtn:".add-rating-radio-btn",openModalButtons:"[data-modal-open]",ratingStars:".rating-stars"},l={visuallyHidden:"visually-hidden",favAdded:"fav-added",modalOpen:"modal-open",gold:"gold"},Z=document.querySelector(o.closeModalButton),C=document.querySelector(o.modalContainer),E=document.querySelector(o.exerciseModal),f=document.querySelector(o.ratingModal),A=document.querySelector(o.addToFavoritesButton);let v=null;async function ee(t){v=t;const e=await p.fetchExercisesById(t);H(e),O(),ie(),C.classList.toggle(l.visuallyHidden),N(),re()}function te(){document.querySelector(o.imgModalExercise).src="",document.querySelector(o.titleModal).textContent="",document.querySelector(o.ratingValue).textContent="0",document.querySelector(o.statsList).innerHTML="",document.querySelector(o.descText).textContent=""}function H(t){te(),document.querySelector(o.imgModalExercise).src=t.gifUrl,document.querySelector(o.titleModal).textContent=t.name.trim(),document.querySelector(o.descText).textContent=t.description.trim(),document.querySelector(o.ratingValue).textContent=t.rating,ce(t.rating),se(t)}function se(t){const e=document.querySelector(o.statsList);e.innerHTML="";let s="";t.target&&(s+=y("Target",t.target)),t.bodyPart&&(s+=y("BodyPart",t.bodyPart)),t.equipment&&(s+=y("Equipment",t.equipment)),t.popularity&&(s+=y("Popular",t.popularity)),t.burnedCalories&&(s+=y("Burned Calories",`${t.burnedCalories}/${t.time} min`)),e.insertAdjacentHTML("beforeend",s)}function y(t,e){return`<li class="stats-item">
    <p class="stats-title">${t}</p>
    <p class="stats-value">${e}</p>
  </li>`}function O(){const t=T().includes(v);A.classList.toggle(l.favAdded,t),document.querySelector(o.btnFavText).textContent=t?"Remove from favorites":"Add to favorites",document.querySelector(o.iconFavBtnUse).setAttribute("href",`./img/svg/sprites.svg#${t?"trash-bin":"heart"}`)}function ie(){A.addEventListener("click",t=>{t.currentTarget.classList.toggle(l.favAdded),X(v),O(),t.stopImmediatePropagation()})}function N(){document.addEventListener("keydown",$),document.body.classList.add(l.modalOpen)}function ne(){document.removeEventListener("keydown",$),document.body.classList.remove(l.modalOpen),v=null}function $(t){t.key==="Escape"&&B()}function B(){f.classList.add(l.visuallyHidden),E.classList.remove(l.visuallyHidden),C.classList.add(l.visuallyHidden),ne()}Z.addEventListener("click",B);C.addEventListener("click",t=>{M(t,E.getBoundingClientRect())||M(t,f.getBoundingClientRect())||B(),t.stopImmediatePropagation()});function M(t,e){return e.top<=t.clientY&&t.clientY<=e.top+e.height&&e.left<=t.clientX&&t.clientX<=e.left+e.width}function re(){const t=document.querySelector(o.openRatingModalButton);document.querySelector(o.addRatingValue).textContent="0",t.addEventListener("click",i=>{f.classList.remove(l.visuallyHidden),E.classList.add(l.visuallyHidden),N(),s(),i.stopImmediatePropagation()}),document.querySelector(o.closeRatingModalButton).addEventListener("click",i=>{f.classList.add(l.visuallyHidden),E.classList.remove(l.visuallyHidden),U(f.querySelector("form")),i.stopImmediatePropagation()});function s(){document.querySelectorAll(o.addRatingRadioBtn).forEach(n=>{n.addEventListener("click",r=>{const c=Number(r.currentTarget.value);document.querySelector(o.addRatingValue).textContent=`${c}`,document.querySelectorAll(o.iconModalRatingStar).forEach((a,u)=>{a.classList.toggle(l.gold,u<c)}),r.stopImmediatePropagation()})})}document.querySelector(o.ratingForm).addEventListener("submit",ae)}function U(t){t.elements.email.value="",t.elements.comment.value="",t.elements.radio.forEach(e=>e.checked=!1),document.querySelector(o.addRatingValue).textContent="0",document.querySelectorAll(o.iconModalRatingStar).forEach(e=>e.classList.remove(l.gold))}async function ae(t){t.preventDefault();const e=parseInt(document.querySelector(o.addRatingValue).textContent??"0"),s=t.target,i=s.elements.email.value,n=s.elements.comment.value;let r=new de;if(!e)r.warning("Choose your rating");else if(!i)r.warning("Enter your email");else if(!n)r.warning("Leave a comment");else{const c=new R(e,i,n),a=await p.patchExerciseRating(v,c);U(s),r.success("Rating successfully updated"),f.classList.add(l.visuallyHidden),E.classList.remove(l.visuallyHidden),H(a)}t.stopImmediatePropagation()}function oe(){document.querySelectorAll(o.openModalButtons).forEach(e=>{e.addEventListener("click",s=>{ee(s.currentTarget.value)})})}function ce(t){const e=document.querySelector(o.ratingStars);e.innerHTML="",e.append(...le(5,t))}function le(t,e){const s=[];for(let i=0;i<t;i++){const n=Math.min(100,Math.max(0,(e-i)*100)),r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttribute("width","18"),r.setAttribute("height","18"),r.setAttribute("class","icon icon-modal-star");const c=`gradient-${i}-${n}`;r.innerHTML=`
      <defs>
        <linearGradient id="${c}" x1="0%" y1="0%" x2="100%" y2="0%">
          <stop offset="${n}%" stop-color="var(--color-accent)" />
          <stop offset="${n}%" stop-color="var(--color-rating)" />
        </linearGradient>
      </defs>
      <use href="./img/svg/sprites.svg#star" fill="url(#${c})"></use>
    `,s.push(r)}return s}class de{warning(e){m.warning({message:e,position:"topCenter"})}success(e){m.success({message:e,position:"topCenter"})}error(e){m.error({message:e,position:"topCenter"})}}class ue{constructor(){this._element=document.createElement("li"),this._element.classList.add("exercises-filters__item"),this._image=document.createElement("img"),this._image.classList.add("exercises-filters__image"),this._image.setAttribute("loading","lazy"),this._overlay=document.createElement("div"),this._overlay.classList.add("exercises-filters__overlay"),this._overlayTitle=document.createElement("h5"),this._overlayText=document.createElement("p"),this._overlayText.classList.add("exercises-filters__overlay-text")}setImage(e){this._image.src=e}setTitle(e){this._overlayTitle.textContent=S(e)}setText(e){this._overlayText.textContent=S(e)}setFilterName(e,s){this._element.dataset.name=e,this._element.dataset.filter=s}setImageAlt(e){this._image.alt=e}build(){return this._overlay.append(this._overlayTitle,this._overlayText),this._element.append(this._image,this._overlay),this._element}}class he{constructor(){this._element=document.createElement("li"),this._element.classList.add("exercises-list__item"),this._header=document.createElement("div"),this._header.classList.add("exercise-header"),this._nameBlock=document.createElement("h3"),this._nameBlock.classList.add("exercise-name"),this._infoBlock=document.createElement("div"),this._infoBlock.classList.add("exercise-info")}addHeader(e,s){const i=document.createElement("div");i.classList.add("exercise-header__left");const n=document.createElement("p");n.classList.add("exercise-workout"),n.textContent="WORKOUT",i.append(n);const r=document.createElement("p");r.classList.add("exercise-rating"),r.textContent=`${e}`;const c=document.createElement("span");c.append(this._createSvg("star","exercise-rating__icon",24,24)),r.append(c),i.append(r);const a=document.createElement("button");a.type="button",a.classList.add("exercise-header__start-button"),a.classList.add("btn-start"),a.textContent="Start",a.value=s,a.setAttribute("data-modal-open",""),a.append(this._createSvg("exercise-start","exercise-arrow",13,13)),this._header.append(i,a)}addName(e){this._nameBlock.append(this._createSvg("runner","exercise-name-icon",13,13)),this._nameBlock.append(e)}addInfo(e,s,i){this._infoBlock.append(this._createInfoTextElement("Burned calories: ",e)),this._infoBlock.append(this._createInfoTextElement("Body part: ",s)),this._infoBlock.append(this._createInfoTextElement("Target: ",i))}build(){return this._element.append(this._header,this._nameBlock,this._infoBlock),this._element}setId(e){this._element.dataset.id=e}_createInfoTextElement(e,s,i="truncate-text"){const n=document.createElement("p");n.classList.add(i);const r=document.createElement("strong");return r.classList.add("exercise-info__title"),r.textContent=e,n.append(r),n.append(document.createTextNode(s)),n}_createSvg(e,s){const i=document.createElement("svg");i.classList.add(s);const n=document.createElement("use");return n.setAttribute("href",`${P}#${e}`),i.appendChild(n),i}}class me{constructor(){if(this._exercisesFilterParent=document.getElementById("exercises-filters"),this._exercisesParent=document.getElementById("exercises-list"),!this._exercisesFilterParent)throw new Error("Exercises filter parent element not found");this._paginationElement=document.querySelector(".exercises-pagination>ul"),this._breadcrumbs=document.querySelector(".breadcrumbs"),this._searchContainer=document.getElementById("search-container"),this._searchInput=this._searchContainer.querySelector(".search-input"),this._page=1,this._limit=12,this._pages=1,this._elements=[],this._isCategory=!1}async init(){this._setPageLimit(),await this._fetchFilters(),this._renderFilters(),this._addEventListeners()}_setPageLimit(){this._page=1,window.innerWidth<=768?this._limit=9:this._limit=12}async _fetchFilters(){const e=this._exercisesFilterParent.querySelector(".exercises-filters__selected");if(!e)throw new Error("Filter button not found");const s=e.dataset.name,i=new F(s,this._page,this._limit);try{const n=await p.fetchFilters(i),r=n.getFilters();this._pages=n.totalPages,r.length>0&&(this._elements=r.map(c=>{const a=new ue;return a.setImage(c.imgURL),a.setTitle(c.name),a.setText(c.filter),a.setFilterName(c.name,c.filter),a.setImageAlt(c.name),a.build()})),this._pages=n.totalPages}catch(n){console.error("Error fetching filters:",n)}}_renderFilters(){this._exercisesParent.replaceChildren(...this._elements),this._renderPagination(),this._addBreadcrumbs(),this._isCategory=!0,localStorage.removeItem("exerciseFilter"),this._searchContainer.classList.add("hidden")}async _onCardClick(e){e.preventDefault();const s=e.target.closest(".exercises-filters__item");if(s){this._searchContainer.classList.remove("hidden"),this._addBreadcrumbs(s.dataset.name);const i=s.dataset.name,n=s.dataset.filter,r=this._buildRequest(i,n);localStorage.setItem("exerciseFilter",JSON.stringify(r)),await this._loadAndRenderExercises(r),oe()}}async _loadAndRenderExercises(e){const s=await p.fetchExercisesByFilter(e);this._renderExercises(s),this._renderPagination(),this._isCategory=!1}_addBreadcrumbs(e=null){if((this._breadcrumbs.children.length>1||!e&&this._breadcrumbs.children.length>1)&&this._breadcrumbs.children[1].remove(),!e)return;const s=document.createElement("li");s.classList.add("breadcrumbs__item");const i=document.createElement("span");i.textContent="/",s.append(i),s.append(S(e)),this._breadcrumbs.append(s)}_renderPagination(){const e=[],s=document.createElement("li");s.classList.add("exercises-pagination__dots"),s.textContent="...";const i=(a,u,x,g)=>{const d=document.createElement("li");d.classList.add("exercises-pagination__item"),d.classList.add(a),d.classList.add("exercises-pagination__arrow"),d.dataset.page=u,this._page===u&&d.classList.add("disabled");const b=document.createElement("svg");b.classList.add(x);const k=document.createElement("use");return k.setAttribute("href",`${P}#${g}`),b.appendChild(k),d.append(b),d},n=()=>{const a=i("exercises-pagination__beginning",1,"exercises-pagination__beginning__arrow","pagination-left-double-arrow"),u=i("exercises-pagination__previous",this._page===1?1:this._page-1,"exercises-pagination__arrow","pagination-left-single-arrow");e.push(a),e.push(u),this._page>=3&&e.push(s)},r=()=>{const a=i("exercises-pagination__last",this._pages,"exercises-pagination__arrow","pagination-right-double-arrow"),u=i("exercises-pagination__next",this._page===this._pages?this._pages:this._page+1,"exercises-pagination__arrow","pagination-right-single-arrow");this._page<=this._pages-2&&e.push(s),e.push(u),e.push(a)},c=(a,u=1)=>{const x=[];for(let g=u;g<=a;g++){const d=document.createElement("li");d.classList.add("exercises-pagination__item"),d.classList.add("exercises-pagination__number"),g===this._page&&d.classList.add("exercises-pagination__current"),d.textContent=g,d.dataset.page=g,x.push(d)}return x};if(this._pages<=3&&e.push(...c(this._pages)),this._pages>3){n();const a=this._page===1?1:this._page===this._pages?this._page-2:this._page-1,u=a+2;e.push(...c(u,a)),r()}this._paginationElement.innerHTML="";for(const a of e)this._paginationElement.innerHTML+=a.outerHTML}async _onPageClick(e){e.preventDefault();const s=e.target.closest(".exercises-pagination__item");if(!s||s.classList.contains("disabled"))return;const i=parseInt(s.dataset.page);if(isNaN(i)||(this._page=i),this._isCategory){await this._fetchFilters(),this._renderFilters();return}const n=JSON.parse(localStorage.getItem("exerciseFilter"));n.page=this._page,localStorage.setItem("exerciseFilter",JSON.stringify(n)),await this._loadAndRenderExercises(n)}_renderExercises(e){if(this._exercisesParent.innerHTML="",!e||!e.results||e.results.length===0){this._exercisesParent.innerHTML="<p>No exercises found.</p>";return}this._pages=e.totalPages;const s=e.getExercises();this._elements=s.map(i=>{const n=new he;return n.setId(i.id),n.addHeader(i.rating,i.id),n.addName(i.name),n.addInfo(i.burnedCalories,i.bodyPart,i.target),n.build()});for(const i of this._elements)this._exercisesParent.innerHTML+=i.outerHTML}async _onFilterClick(e){e.preventDefault(),this._setPageLimit(),this._exercisesFilterParent.querySelectorAll(".exercises-filters__selected").forEach(i=>{i.classList.remove("exercises-filters__selected")}),e.target.classList.add("exercises-filters__selected"),await this._fetchFilters(),this._renderFilters()}_addEventListeners(){this._exercisesFilterParent.removeEventListener("click",this._onFilterClick.bind(this)),this._exercisesFilterParent.addEventListener("click",this._onFilterClick.bind(this)),this._exercisesParent.removeEventListener("click",this._onCardClick.bind(this)),this._exercisesParent.addEventListener("click",this._onCardClick.bind(this)),this._paginationElement.addEventListener("click",this._onPageClick.bind(this)),this._searchContainer.querySelector(".search-button").addEventListener("click",this._onSearchClick.bind(this)),this._searchInput.addEventListener("keyup",this._onSearchKeyUp.bind(this))}async _onSearchClick(e){e.preventDefault();const s=this._searchInput.value.trim();if(s){const i=JSON.parse(localStorage.getItem("exerciseFilter"));i.keyword=s,localStorage.setItem("exerciseFilter",JSON.stringify(i)),this._searchInput.value="",await this._loadAndRenderExercises(i)}}async _onSearchKeyUp(e){e.preventDefault();const s=this._searchInput.value.trim();e.key==="Enter"&&s&&await this._onSearchClick(e)}_buildRequest(e,s){if(s.toLowerCase()==="muscles")return new L(null,e,null,null,this._page,this._limit);if(s.toLowerCase()==="equipment")return new L(null,null,e,null,this._page,this._limit);if(s.toLowerCase()==="body parts")return new L(e,null,null,null,this._page,this._limit)}}const pe=new me,h=new G,ge=new F("Body parts",1,5);h.show();p.fetchFilters(ge).then(t=>{console.log("Response:",t),console.log("Filters:",t.getFilters())}).catch(t=>{console.error("Error:",t)}).finally(()=>{h.hide()});const _e=new L("back","lats","barbell","pull",1,5);h.show();p.fetchExercisesByFilter(_e).then(t=>{console.log("Response:",t),console.log("Exercises:",t.getExercises())}).catch(t=>{console.error("Error:",t)}).finally(()=>{h.hide()});const V="64f389465ae26083f39b1ab2";h.show();p.fetchExercisesById(V).then(t=>{console.log("Response:",t)}).catch(t=>{console.error("Error:",t)}).finally(()=>{h.hide()});const fe=new R(3,`test${Date.now()}@gmail.com`,"Great exercise! Very effective.");h.show();p.patchExerciseRating(V,fe).then(t=>{console.log("Response:",t)}).catch(t=>{console.error("Error:",t)}).finally(()=>{h.hide()});h.show();p.fetchQuoteOfTheDay().then(t=>{console.log("Quote of the Day:",t),console.log("Quote:",t.quote),console.log("Author:",t.author)}).catch(t=>{console.error("Error fetching quote:",t)}).finally(()=>{h.hide()});const ye=`sub_test${Date.now()}@gmail.com`;h.show();p.postSubscription(ye).then(t=>{console.log("Subscription Response:",t)}).catch(t=>{console.error("Error:",t)}).finally(()=>{h.hide()});document.addEventListener("DOMContentLoaded",()=>{z()});pe.init();document.addEventListener("DOMContentLoaded",()=>{var n;const t=document.getElementById("subscriptionForm"),e=(n=t==null?void 0:t.elements)==null?void 0:n.email,s=r=>{m.warning({message:r,position:"topCenter"})},i=r=>{m.success({message:r,position:"topCenter"}),e.value=""};t==null||t.addEventListener("submit",async r=>{if(r.preventDefault(),!e.checkValidity()){s("Please enter a valid email address.");return}const c=await p.postSubscription(e.value.trim());i(c)})});document.addEventListener("DOMContentLoaded",function(){const t=document.querySelectorAll(".nav-list-link"),e=document.querySelectorAll(".copyright-link"),s=window.location.pathname.split("/").filter(n=>n&&n.length>0);let i;s.length==0?i="index.html":i=s[s.length-1],t.forEach(n=>{n.getAttribute("href").endsWith(i)&&n.classList.add("active")}),e.forEach(n=>{n.getAttribute("href").endsWith(i)&&n.classList.add("active")})});export{p as y};
//# sourceMappingURL=nav-Fdyf9ux1.js.map
